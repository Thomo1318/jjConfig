#!/usr/bin/env bash
# Security Pre-Push Hook
# Automatically sanitizes sensitive information before pushing
# Version: 2.2.0 - Comprehensive sanitization including repomix files

set -e

echo "üîí Running pre-push security check..."

# Check if sanitization script exists
if [ ! -f .build-artifacts/sanitize_all.py ]; then
    echo "‚ö†Ô∏è  Sanitization script not found"
    echo "   Expected: .build-artifacts/sanitize_all.py"
    exit 0
fi

# Run comprehensive sanitization (includes repomix files)
python3 .build-artifacts/sanitize_all.py

# Stage all sanitized files
git add -u

echo ""
echo "‚úÖ All files sanitized (including .repomix/)"
echo "   Real email ‚Üí Placeholder for public repo"
echo ""
echo "‚ö†Ô∏è  Note: After push, restore locally with:"
echo "   sed -i '' 's/YOUR_EMAIL@example.com/steele.thompson13@gmail.com/g' config.toml README.md QUICKSTART.md TASKS.md"

exit 0
